import{k as V,u as C,r as f,l as h,m as y,o as s,d as S,e as _,g as c,G as k,w,b as x,E as B,s as g}from"./index-DqFNnomA.js";import{C as a}from"./index-BrxgAE_R.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";function K(l,e){const d=a.enc.Utf8.parse(l);return a.AES.encrypt(d,a.enc.Utf8.parse(e),{mode:a.mode.CBC,padding:a.pad.Pkcs7,iv:a.enc.Utf8.parse(e)}).toString()}async function U(l,e){return V.post("/login",{pwd:K(l,e)})}function b(){return V.put("/getPwdAesKey")}const P={class:"container"},A={class:"btn"},I={__name:"login",setup(l){const e=x(),d=C(),t=f(""),n=f(!0),r=f("");h(async()=>{d.psw==0&&e.push("/link");let o=await b();r.value=o.key});async function i(){if(t.value==""){B.error("请输入密码");return}if(n.value!=!1){if(n.value=!1,r.value==""){let o=await b();r.value=o.key}try{let o=await U(t.value,r.value);sessionStorage.setItem("token",o.token),e.push("/")}catch{}finally{n.value=!0}}}return(o,u)=>{const m=y("el-input"),v=y("el-button");return s(),S("div",P,[_("div",null,[n.value?(s(),c(m,{key:0,modelValue:t.value,"onUpdate:modelValue":u[0]||(u[0]=p=>t.value=p),onKeyup:k(i,["enter"]),"show-password":""},null,8,["modelValue"])):(s(),c(m,{key:1,modelValue:t.value,"onUpdate:modelValue":u[1]||(u[1]=p=>t.value=p),onKeyup:k(i,["enter"]),"show-password":"",disabled:""},null,8,["modelValue"]))]),_("div",A,[n.value?(s(),c(v,{key:0,color:"rgb(0,116,232)",onClick:i},{default:w(()=>[g("登录")]),_:1})):(s(),c(v,{key:1,color:"rgb(0,116,232)"},{default:w(()=>[g("登录中...")]),_:1}))])])}}},J=E(I,[["__scopeId","data-v-dc0410bc"]]);export{J as default};
